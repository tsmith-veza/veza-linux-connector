# This file MUST be edited with the 'visudo' command as root.
#
# See the sudoers(5) man page for details on privileges.

# User alias specification
# These aliases have been anonymized and made more realistic.
User_Alias IT_SUPPORT = jsmith, m_jones, c_adams, l_brown, d_white, r_green, s_king, t_clark, p_hall, k_scott, a_taylor
User_Alias HELPDESK_STAFF = jdoe, r_williams, j_miller, c_davis, g_wilson, b_moore, c_taylor, r_thomas, m_jackson, p_white, s_harris, e_martin, a_thompson, p_garcia, m_rodriguez, b_davis, a_martinez, p_hernandez, m_lopez, b_gonzalez, a_perez, p_sanchez, m_ramirez, b_campbell, a_rivera, p_gonzalez, m_carter, b_mitchell, a_roberts
User_Alias PHIL_TEAM = a_lee, e_nguyen, b_kim, r_chen, d_wang, m_li, y_zhang
User_Alias CAN_BRANCH = j_wilson, c_davis, a_smith, m_jones, m_brown
User_Alias USA_BRANCH = m_jones, m_brown
User_Alias FINANCE_TEAM = n_patel, a_singh, j_khan, m_ali, m_ahmed, e_davis, a_johnson, v_kumar, p_sharma, r_gupta, a_verma, v_reddy, s_rao, t_yadav, j_singh, v_pandey, s_mishra, k_garg, a_dubey, g_chaudhary, a_malik, g_khan, l_kumar, a_verma, s_gupta, k_sharma, a_chaudhary, g_singh, l_patel, a_jain, s_mehta, k_agarwal, a_bhatia, g_mittal, l_gupta, a_jain, s_arora, k_verma, a_goel, g_agrawal
User_Alias OPERATIONS = n_patel, m_ahmed
User_Alias SYS_ADMINS = root # This alias maps the 'root' user to a generic ADMIN alias.

# Cmnd alias specification
# Define aliases for common commands to simplify rules.
Cmnd_Alias SYSTEM_SERVICES = /usr/bin/systemctl restart, /usr/bin/systemctl stop, /usr/bin/systemctl start
Cmnd_Alias LOG_VIEWING = /usr/bin/tail, /usr/bin/cat /var/log/syslog, /usr/bin/cat /var/log/auth.log
Cmnd_Alias PACKAGE_MANAGEMENT = /usr/bin/apt update, /usr/bin/apt upgrade, /usr/bin/apt install, /usr/bin/apt remove

# User privilege specification
# Default root user rule
root    ALL=(ALL:ALL) ALL

# Allow members of group sudo to execute any command (from previous discussion)
%sudo   ALL=(ALL:ALL) ALL

# Allow members of group wheel to execute any command (from previous discussion)
%wheel  ALL=(ALL:ALL) ALL

# --- Rules using the User_Alias definitions ---

# Allow IT_SUPPORT users to manage specific system services without password
IT_SUPPORT ALL=(root) NOPASSWD: SYSTEM_SERVICES

# Allow HELPDESK_STAFF users to view logs without password
HELPDESK_STAFF ALL=(root) NOPASSWD: LOG_VIEWING

# Allow OPERATIONS users to perform package management tasks with password
OPERATIONS ALL=(root) PACKAGE_MANAGEMENT

# The SYS_ADMINS alias (which is 'root') already has full access from the default rule,
# but you could use it for clarity or to define specific NOPASSWD rules if needed.
# SYS_ADMINS ALL=(ALL) NOPASSWD: ALL

# --- End Custom Rules ---

# See sudoers(5) for more information on "@include" and "@includedir" directives.
#includedir /etc/sudoers.d
